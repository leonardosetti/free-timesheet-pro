<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Timesheet Pro - FOSS PJ/Freelancer Tracker</title>
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#2563eb">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #1f2937;
    }
    .container { 
      max-width: 600px; 
      margin: 0 auto; 
      padding: 20px; 
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .card { 
      background: rgba(255,255,255,0.95);
      backdrop-filter: blur(10px);
      border-radius: 20px; 
      padding: 32px; 
      box-shadow: 0 20px 40px rgba(0,0,0,0.1);
      border: 1px solid rgba(255,255,255,0.2);
    }
    h1 { 
      font-size: 2.2em; 
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
    }
    h2 { font-size: 1.8em; color: #1f2937; margin-bottom: 16px; }
    input, select, button { 
      width: 100%; 
      padding: 14px 16px; 
      margin: 12px 0; 
      border: 2px solid #e5e7eb; 
      border-radius: 12px; 
      font-size: 16px; 
      transition: all 0.2s;
    }
    input:focus, select:focus { 
      outline: none; 
      border-color: #2563eb; 
      box-shadow: 0 0 0 3px rgba(37,99,235,0.1);
    }
    button { 
      background: linear-gradient(135deg, #2563eb, #1d4ed8);
      color: white; 
      border: none; 
      cursor: pointer; 
      font-weight: 600; 
      font-size: 16px;
      box-shadow: 0 4px 14px rgba(37,99,235,0.3);
    }
    button:hover:not(:disabled) { 
      transform: translateY(-1px); 
      box-shadow: 0 6px 20px rgba(37,99,235,0.4);
    }
    button:disabled { 
      background: #9ca3af; 
      cursor: not-allowed; 
      transform: none;
    }
    .loading { 
      display: none; 
      margin: 16px 0;
    }
    .loading.active { display: inline-block; }
    .loading.active::after {
      content: ' ‚è≥ ';
      animation: spin 1s linear infinite;
    }
    @keyframes spin { 100% { transform: rotate(360deg); } }
    .metrics { 
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); 
      gap: 20px; 
      margin: 24px 0;
    }
    .metric { 
      text-align: center; 
      padding: 20px; 
      background: rgba(37,99,235,0.05); 
      border-radius: 12px;
    }
    .metric h3 { color: #6b7280; font-size: 14px; margin-bottom: 8px; }
    .metric-value { font-size: 2.2em; font-weight: 700; }
    .metric-usd { color: #059669; }
    .metric-brl { color: #dc2626; }
    @media (max-width: 640px) { 
      .container { padding: 16px; } 
      .card { padding: 24px; }
      h1 { font-size: 1.8em; }
    }
  </style>
</head>
<body>
  <div id="app" class="container">
    <!-- Conte√∫do din√¢mico carregado via JS -->
  </div>
  
  <script type="module">
    // Timesheet Pro v2.2 - PWA Core
    class TimesheetApp {
      constructor() {
        this.currentView = 'welcome';
        this.demoData = {
          horasSemana: 42,
          valorBruto: 2150.50,
          regime: 'nenhum',
          moeda: 'BRL'
        };
        this.init();
      }

      async init() {
        this.registerSW();
        this.showWelcome();
        this.bindEvents();
      }

      registerSW() {
        if ('serviceWorker' in navigator) {
          navigator.serviceWorker.register('/sw.js')
            .then(reg => console.log('SW registrado:', reg))
            .catch(err => console.warn('SW falhou:', err));
        }
      }

      showWelcome() {
        document.getElementById('app').innerHTML = `
          <div class="card">
            <h1>üöÄ Timesheet Pro v2.2</h1>
            <p><strong>FOSS PJ/Freelancer Hours Tracker</strong></p>
            <p>3 regimes: Banco | Extras | <em>Pay as You Go</em></p>
            <div class="loading active">Carregando demo...</div>
            <button onclick="app.showDashboard()">üìä Ver Dashboard</button>
            <button onclick="app.showConfig()" style="background: #059669;">‚öôÔ∏è Configura√ß√µes</button>
          </div>
        `;
        
        setTimeout(() => {
          document.querySelector('.loading').classList.remove('active');
        }, 1500);
      }

      showDashboard() {
        document.getElementById('app').innerHTML = `
          <div class="card">
            <h2>üìä Dashboard Semanal</h2>
            <div class="metrics">
              <div class="metric">
                <h3>Horas Trabalhadas</h3>
                <div class="metric-value">${this.demoData.horasSemana}h</div>
              </div>
              <div class="metric">
                <h3>Valor Bruto</h3>
                <div class="metric-value metric-${this.demoData.moeda.toLowerCase()}">
                  R$ ${this.demoData.valorBruto.toLocaleString('pt-BR')}
                </div>
              </div>
              <div class="metric">
                <h3>Regime Atual</h3>
                <div>${this.demoData.regime === 'nenhum' ? 'üí∏ Pay as You Go' : this.demoData.regime}</div>
              </div>
            </div>
            <button onclick="app.showWelcome()">‚Üê Voltar</button>
          </div>
        `;
      }

      showConfig() {
        document.getElementById('app').innerHTML = `
          <div class="card">
            <h2>‚öôÔ∏è Configura√ß√µes</h2>
            <div style="display: grid; gap: 16px;">
              <div>
                <label>Regime de Horas:</label>
                <select>
                  <option>Banco de Horas</option>
                  <option>Horas Extras</option>
                  <option selected>Pay as You Go (nenhum)</option>
                </select>
              </div>
              <div>
                <label>Valor Hora Base:</label>
                <input type="number" step="0.01" value="45.50" placeholder="R$ 45,50">
              </div>
              <div>
                <label>Valor Hora Extra:</label>
                <input type="number" step="0.01" value="67.25" placeholder="R$ 67,25">
              </div>
              <div>
                <label>% Extra:</label>
                <input type="number" value="47" placeholder="47%"> %
              </div>
              <div>
                <label>Moeda:</label>
                <select>
                  <option selected>BRL</option>
                  <option>USD (c√¢mbio auto)</option>
                </select>
              </div>
              <button onclick="app.saveConfig()">üíæ Salvar Configura√ß√µes</button>
              <button onclick="app.showWelcome()" style="background: #6b7280;">‚Üê Voltar</button>
            </div>
          </div>
        `;
      }

      saveConfig() {
        alert('‚úÖ Configura√ß√µes salvas! (Demo)');
        this.showWelcome();
      }

      bindEvents() {
        document.addEventListener('click', (e) => {
          if (e.target.matches('button[onclick]')) {
            // Handled by onclick
          }
        });
      }
    }

    // Inicializar app
    const app = new TimesheetApp();

    // PWA Install Prompt
    let deferredPrompt;
    window.addEventListener('beforeinstallprompt', (e) => {
      e.preventDefault();
      deferredPrompt = e;
      console.log('PWA pode ser instalada!');
    });
  </script>
</body>
</html>
